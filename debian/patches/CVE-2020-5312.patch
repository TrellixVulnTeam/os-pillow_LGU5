--- pillow-5.4.1.orig/Tests/test_image.py
+++ pillow-5.4.1/Tests/test_image.py
@@ -539,6 +539,8 @@ class TestImage(PillowTestCase):
             "pcx_overrun.bin",
             "sgi_overrun_expandrow.bin",
             "sgi_overrun_expandrow2.bin",
+            "pcx_overrun.bin",
+            "pcx_overrun2.bin",
             ]:
             im = Image.open(os.path.join("Tests/images", file))
             try:
--- pillow-5.4.1.orig/src/libImaging/PcxDecode.c
+++ pillow-5.4.1/src/libImaging/PcxDecode.c
@@ -25,6 +25,9 @@ ImagingPcxDecode(Imaging im, ImagingCode
     if (strcmp(im->mode, "1") == 0 && state->xsize > state->bytes * 8) {
         state->errcode = IMAGING_CODEC_OVERRUN;
         return -1;
+    } else if (strcmp(im->mode, "P") == 0 && state->xsize > state->bytes) {
+        state->errcode = IMAGING_CODEC_OVERRUN;
+        return -1;
     }
 
     ptr = buf;
